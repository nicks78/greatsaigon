{"version":3,"sources":["webpack:///./pages/search-page.js?b98f"],"names":["SearchPage","updateResult","setState","where","props","url","query","what","directory","console","log","state","api","getList","handleSearch","as","href","Router","replace","shallow","handleFilterButtons","filterIcons","event","target","getAttribute","valueInput","value","apiFilters","axios","get","then","result","response","data","forEach","req","options","beauty","hair","treatment","res","stockResult","unshift","nails","spa","_","uniq","catch","error","next","prev","page","isToggle","nextProps","list","isFecthing","drop_what","height","overflow","status","map","x","index","marginBottom","msg","zIndex","React","Component","mapStateToProps","dataReducer","mapDispatchToProps","dispatch","Page","connect"],"mappings":"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","file":"4.61ef8b5c722998162b66.hot-update.js","sourcesContent":["import React from \"react\";\nimport { connect } from \"react-redux\";\nimport Router from 'next/router'\nimport Layout from \"../components/layout\";\nimport { getList } from \"../redux/data/actions\";\nimport SearchBar from \"../components/search-bar\";\nimport Map from \"../components/map\";\nimport CardVenue from \"../components/cards/card-venue\";\nimport Filter from \"../components/filters/filter\";\nimport Page from \"../components/page\";\nimport Loader from \"../components/loader\";\nimport axios from \"axios\";\nimport _ from \"lodash\";\n\nclass SearchPage extends React.Component {\n  constructor() {\n    super();\n\n    this.state = {\n      what: \"1\",\n      where: \"\",\n      directory: \"1\",\n      next: 10,\n      prev: 0,\n      page: 1,\n      isToggle: false,\n      stockResult: [],\n      result: []\n    };\n  }\n\n  componentDidMount() {\n    console.log(\"PROPS\", this.props.url.query)\n    if (this.props.url)\n      this.updateResult();\n  }\n\n  componentWillUpdate(){\n    this.updateResult();\n  }\n\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.url)\n      this.setState({\n        result: nextProps.result.list\n      });\n  }\n\n  updateResult = () => {\n    this.setState({\n      where: this.props.url.query.where,\n      what: this.props.url.query.what,\n      directory: this.props.url.query.directory\n    }, () => {\n      console.log('WHERE-2', this.state.where)\n      var api = `venues/search?items=1000&page=1&what=${\n        this.state.what\n      }&directory=${this.state.directory}&where=${this.state.where}`;\n      \n      this.props.getList(api);\n    })\n  }\n\n  handleSearch = ( directory, where, what ) => {\n    var as = `/search-page/${directory || 'food-and-drink' }/${where || ''}/${what || 'restaurant'}`\n    var href = `/search-page?directory=${directory || 'food-and-drink' }&where=${where || '1'}&what=${what || 'restaurant'}`\n    Router.replace(href, as, {shallow: true})\n    var api = `venues/search?items=1000&page=1&what=${\n      what\n    }&directory=${directory}&where=${where}`;\n    this.props.getList(api);\n\n  }\n\n  handleFilterButtons = event => {\n    var filterIcons = event.target.getAttribute(\"name\");\n    var valueInput = event.target.value;\n    var apiFilters = `https://backend.greatsaigon.com/api/v1/en/directories/${\n      this.state.directory\n    }/venues`;\n    axios\n      .get(apiFilters)\n      .then(response => {\n        let result;\n\n        response.data.forEach(req => {\n          if (filterIcons === \"Hair\") {\n            if (req.options.beauty.hair.treatment !== \"0\") {\n              req.options.beauty.hair.treatment.forEach(res => {\n                if (res === valueInput) {\n                  result = req;\n                  this.state.stockResult.unshift(result);\n                }\n              });\n            }\n          } else if (filterIcons === \"Nails\") {\n            if (req.options.beauty.nails.treatment !== \"0\") {\n              req.options.beauty.nails.treatment.forEach(res => {\n                if (res === valueInput) {\n                  result = req;\n                  this.state.stockResult.unshift(result);\n                }\n              });\n            }\n          } else if (filterIcons === \"Spa & Massage\") {\n            if (req.options.beauty.spa.treatment !== \"0\") {\n              req.options.beauty.spa.treatment.forEach(res => {\n                if (res === valueInput) {\n                  result = req;\n                  this.state.stockResult.unshift(result);\n                }\n              });\n            }\n          }\n        });\n\n        this.setState({\n          result: _.uniq(this.state.stockResult)\n        });\n      })\n      .catch(function(error) {\n        console.log(error);\n      });\n  };\n\n  render() {\n\n    if (this.props.result.isFecthing) {\n      return <Loader />;\n    }\n\n    const { where, what, directory, result, drop_what } = this.state;\n\n    return (\n      <Layout>\n        <div className=\"wrapper-search-bar\">\n          <SearchBar what={what} where={where} directory={directory} handleSearch={ this.handleSearch }/>\n        </div>\n\n        <div className=\"content\">\n          <div data-uk-grid>\n            {this.state.directory === \"beauty\" && (\n              <div className=\"uk-width-auto@m\">\n                <Filter onClick={this.handleFilterButtons} />\n              </div>\n            )}\n            <div\n              style={{\n                height: \"100vh\",\n                overflow: \"auto\"\n              }}\n              className=\"gs-scroll-section uk-width-expand@m\"\n            >\n              {!result.status ? (\n                result.map((x, index) => {\n                  return (\n                    <div key={index} style={{ marginBottom: \"10px\" }}>\n                      <CardVenue venue={x} />\n                    </div>\n                  );\n                })\n              ) : (\n                <p>{result.msg}</p>\n              )}\n            </div>\n\n            <div\n              style={{ zIndex: \"980\" }}\n              id=\"map\"\n              className=\"uk-width-1-3@m\"\n              data-uk-scrollspy=\"cls: uk-animation-slide-right; repeat: false\"\n            >\n              {!result.status ? <Map result={result} isSingle={false} /> : null}\n            </div>\n          </div>\n        </div>\n        <style jsx global>\n          {`\n            .content {\n              background-color: #f1f1f2;\n              border-bottom: 1px solid #d0d2d3;\n              margin: 1em auto;\n              max-width: 100% !important;\n            }\n            .filters_icon {\n              display: grid;\n              grid-template-columns: repeat(2, 1fr);\n            }\n            .fas {\n              cursor: pointer;\n            }\n            #map {\n              height: 100vh;\n            }\n            @media (max-width: 960px) {\n              .content {\n                margin: 0 auto;\n                width: 100%;\n              }\n              #map {\n                display: none !important;\n              }\n              .gs-scroll-section {\n                overflow: ;\n              }\n            }\n          `}\n        </style>\n      </Layout>\n    );\n  }\n}\n\n// Get all data for child components\nconst mapStateToProps = state => {\n  return {\n    result: state.dataReducer\n  };\n};\n\n// Get all data for child components\nconst mapDispatchToProps = dispatch => {\n  return {\n    getList: api => dispatch(getList(api))\n  };\n};\n\nexport default Page(\n  connect(\n    mapStateToProps,\n    mapDispatchToProps\n  )(SearchPage)\n);\n\n\n\n// WEBPACK FOOTER //\n// ./pages/search-page.js"],"sourceRoot":""}