{"version":3,"sources":["webpack:///./pages/search-page.js?b98f"],"names":["SearchPage","handleSearch","directory","where","what","as","href","Router","replace","shallow","api","props","getList","handleFilterButtons","filterIcons","event","target","getAttribute","valueInput","value","apiFilters","state","axios","get","then","result","response","data","forEach","req","options","beauty","hair","treatment","res","stockResult","unshift","nails","spa","setState","_","uniq","catch","error","console","log","next","prev","page","isToggle","url","updateResult","nextProps","list","query","isFecthing","drop_what","height","overflow","status","map","x","index","marginBottom","msg","zIndex","React","Component","mapStateToProps","dataReducer","mapDispatchToProps","dispatch","Page","connect"],"mappings":"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","file":"4.714202dcbefdf1ee5459.hot-update.js","sourcesContent":["import React from \"react\";\nimport { connect } from \"react-redux\";\nimport Router from 'next/router'\nimport Layout from \"../components/layout\";\nimport { getList } from \"../redux/data/actions\";\nimport SearchBar from \"../components/search-bar\";\nimport Map from \"../components/map\";\nimport CardVenue from \"../components/cards/card-venue\";\nimport Filter from \"../components/filters/filter\";\nimport Page from \"../components/page\";\nimport Loader from \"../components/loader\";\nimport axios from \"axios\";\nimport _ from \"lodash\";\n\nclass SearchPage extends React.Component {\n  constructor() {\n    super();\n\n    this.state = {\n      what: \"1\",\n      where: \"\",\n      directory: \"1\",\n      next: 10,\n      prev: 0,\n      page: 1,\n      isToggle: false,\n      stockResult: [],\n      result: []\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.url)\n      this.updateResult();\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.url)\n      this.setState({\n        result: nextProps.result.list\n      });\n  }\n\n  updateResult() {\n    this.setState({\n      where: this.props.url.query.where,\n      what: this.props.url.query.what,\n      directory: this.props.url.query.directory\n    }, () => {\n      console.log('WHERE-2', this.state.where)\n      var api = `venues/search?items=1000&page=1&what=${\n        this.state.what\n      }&directory=${this.state.directory}&where=${this.state.where}`;\n      \n      this.props.getList(api);\n    })\n  }\n\n  handleSearch = ( directory, where, what ) => {\n    var as = `/search-page/${directory || 'food-and-drink' }/${where || ''}/${what || 'restaurant'}`\n    var href = `/search-page?directory=${directory || 'food-and-drink' }&where=${where || '1'}&what=${what || 'restaurant'}`\n    Router.replace(href, as, {shallow: true})\n    var api = `venues/search?items=1000&page=1&what=${\n      what\n    }&directory=${directory}&where=${where}`;\n    this.props.getList(api);\n\n  }\n\n  handleFilterButtons = event => {\n    var filterIcons = event.target.getAttribute(\"name\");\n    var valueInput = event.target.value;\n    var apiFilters = `https://backend.greatsaigon.com/api/v1/en/directories/${\n      this.state.directory\n    }/venues`;\n    axios\n      .get(apiFilters)\n      .then(response => {\n        let result;\n\n        response.data.forEach(req => {\n          if (filterIcons === \"Hair\") {\n            if (req.options.beauty.hair.treatment !== \"0\") {\n              req.options.beauty.hair.treatment.forEach(res => {\n                if (res === valueInput) {\n                  result = req;\n                  this.state.stockResult.unshift(result);\n                }\n              });\n            }\n          } else if (filterIcons === \"Nails\") {\n            if (req.options.beauty.nails.treatment !== \"0\") {\n              req.options.beauty.nails.treatment.forEach(res => {\n                if (res === valueInput) {\n                  result = req;\n                  this.state.stockResult.unshift(result);\n                }\n              });\n            }\n          } else if (filterIcons === \"Spa & Massage\") {\n            if (req.options.beauty.spa.treatment !== \"0\") {\n              req.options.beauty.spa.treatment.forEach(res => {\n                if (res === valueInput) {\n                  result = req;\n                  this.state.stockResult.unshift(result);\n                }\n              });\n            }\n          }\n        });\n\n        this.setState({\n          result: _.uniq(this.state.stockResult)\n        });\n      })\n      .catch(function(error) {\n        console.log(error);\n      });\n  };\n\n  render() {\n\n    if (this.props.result.isFecthing) {\n      return <Loader />;\n    }\n\n    const { where, what, directory, result, drop_what } = this.state;\n\n    return (\n      <Layout>\n        <div className=\"wrapper-search-bar\">\n          <SearchBar what={what} where={where} directory={directory} handleSearch={ this.handleSearch }/>\n        </div>\n\n        <div className=\"content\">\n          <div data-uk-grid>\n            {this.state.directory === \"beauty\" && (\n              <div className=\"uk-width-auto@m\">\n                <Filter onClick={this.handleFilterButtons} />\n              </div>\n            )}\n            <div\n              style={{\n                height: \"100vh\",\n                overflow: \"auto\"\n              }}\n              className=\"gs-scroll-section uk-width-expand@m\"\n            >\n              {!result.status ? (\n                result.map((x, index) => {\n                  return (\n                    <div key={index} style={{ marginBottom: \"10px\" }}>\n                      <CardVenue venue={x} />\n                    </div>\n                  );\n                })\n              ) : (\n                <p>{result.msg}</p>\n              )}\n            </div>\n\n            <div\n              style={{ zIndex: \"980\" }}\n              id=\"map\"\n              className=\"uk-width-1-3@m\"\n              data-uk-scrollspy=\"cls: uk-animation-slide-right; repeat: false\"\n            >\n              {!result.status ? <Map result={result} isSingle={false} /> : null}\n            </div>\n          </div>\n        </div>\n        <style jsx global>\n          {`\n            .content {\n              background-color: #f1f1f2;\n              border-bottom: 1px solid #d0d2d3;\n              margin: 1em auto;\n              max-width: 100% !important;\n            }\n            .filters_icon {\n              display: grid;\n              grid-template-columns: repeat(2, 1fr);\n            }\n            .fas {\n              cursor: pointer;\n            }\n            #map {\n              height: 100vh;\n            }\n            @media (max-width: 960px) {\n              .content {\n                margin: 0 auto;\n                width: 100%;\n              }\n              #map {\n                display: none !important;\n              }\n              .gs-scroll-section {\n                overflow: ;\n              }\n            }\n          `}\n        </style>\n      </Layout>\n    );\n  }\n}\n\n// Get all data for child components\nconst mapStateToProps = state => {\n  return {\n    result: state.dataReducer\n  };\n};\n\n// Get all data for child components\nconst mapDispatchToProps = dispatch => {\n  return {\n    getList: api => dispatch(getList(api))\n  };\n};\n\nexport default Page(\n  connect(\n    mapStateToProps,\n    mapDispatchToProps\n  )(SearchPage)\n);\n\n\n\n// WEBPACK FOOTER //\n// ./pages/search-page.js"],"sourceRoot":""}